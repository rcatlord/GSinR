---
title: | 
    | Getting Started in R
    | an introduction to data analysis and visualisation
subtitle: "Modeling Data"
author: "RÃ©ka Solymosi, Sam Langton & Emily Buehler"
date: "4 July 2019"
output:
  xaringan::moon_reader:
    css: ["default", "my-theme.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

class: inverse, center, middle

# Modeling Data

---
## Making inferences from data


---
## Univariate 

### Summary of one variable


---
## Univariate 

For all variables in dataframe

```{r, echo=FALSE, warning=F}
library(gapminder)
```

```{r}
summary(gapminder)
```

---
## Univariate 

For all variables in dataframe with skimr

```{r, warning=F, message=F}
library(skimr)
```

---

```{r}
gapminder %>%  skim()
```


---
## Bivariate stats 

### making comparisons

---
## Numeric - numeric

```{r, eval=FALSE}
cor(var1, var2, method = "pearson") # kendall, spearman
```

```{r, eval=FALSE}
cor.test(var1, var2, method = "pearson") # kendall, spearman
```

---
## Categorical - categorical

### Cross tabs

```{r, eval=FALSE}

chisq.test(table(var1, var2))

```

```{r, eval=FALSE}
fisher.test(table(var1, var2))
```

---
## Categorical - categorical

### Odds ratio

```{r, eval = FALSE}
library(vcd)

oddsratio(table(var1, var2)) 
```

---
## Categorical - numeric

```{r, eval = FALSE}

# t-test
t.test(var1 ~ var2)

# anova
aov(var1 ~ var2, data=mydataframe)


```

---
## Multivariable 

```{r, eval = FALSE}

fit_1 <- glm(dependent_var ~ independent_var_1 + independent_var_2, data = mydata)
summary(fit_1)

```

---
## Multivariable

```{r}
fit_2 <- glm(lifeExp ~ continent + gdpPercap, data = gapminder)
summary(fit_2)

```

---
## Multivariable

```{r, warning = F, message = F, out.height="450px"}
library(car)
residualPlots(fit_2)
```

---
## Multivariable

```{r, warning = F, message = F, out.height="350px"}
marginalModelPlots(fit_2)

```

---
## Multivariable

```{r, warning=FALSE, message=FALSE, out.height="350px"}
library(effects)
plot(allEffects(fit_2))
```

---
## Multivariable

```{r, warning=FALSE, message=FALSE, out.height="350px"}
library(sjPlot)
plot_model(fit_2, show.values = TRUE)
```

---

## Multivariable

```{r, warning=FALSE, message=FALSE}
p1 <- plot_model(fit_2)
```

```{r, echo = F, warning = F, message = F}
library(ggplot2)
```

```{r, eval=F, warning = F, message = F}
ggplot(p1$data) + theme_minimal() +
  geom_vline(xintercept = 1, linetype = "dashed") +
  geom_errorbarh(aes(xmin = conf.low, xmax = conf.high, y = term), height = 0.2) +
  geom_point(aes(y = term, x = estimate), size = 3, col = "red") +
  labs(y = " ", x = "Estimate") + xlim(0,23) +
  scale_y_discrete(labels = c("GDP","Oceania","Europe","Asia","America"))
```

---

## Multivariable

```{r, echo = F, out.width="600px", fig.align = "center", fig.asp = .62}
ggplot(p1$data) + theme_bw() +
  geom_vline(xintercept = 0, linetype = "dashed") +
  geom_errorbarh(aes(xmin = conf.low, xmax = conf.high, y = term), height = 0.2) +
  geom_point(aes(y = term, x = estimate), size = 3, col = "black") +
  labs(y = " ", x = "Estimate", title = "Figure 1: regression results example") +
  xlim(0,23) +
  scale_y_discrete(labels = c("GDP","Oceania","Europe","Asia","America"))
```